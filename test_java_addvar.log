
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      StataNow 18.5
___/   /   /___/   /   /___/       MP—Parallel Edition

 Statistics and Data Science       Copyright 1985-2023 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: Unlimited-user 16-core network, expiring  2 Jul 2026
Serial number: 501909320077
  Licensed to: Michael Droste
               Stanford University GSB

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. More than 2 billion observations are allowed; see help obs_advice.
      4. Maximum number of variables is set to 5,000 but can be increased;
          see help set_maxvar.


Running /Users/Mike/Documents/Stata/profile.do ...

. do test_java_addvar.do 

. * Test Java variable creation vs Mata _st_addvar
. clear all

. set more off

. 
. local classpath "/Users/Mike/Documents/GitHub/stata-ctools"

. 
. * Create test dataset with many observations
. set obs 50000000
Number of observations (_N) was 0, now 50,000,000.

. 
. * Test 1: Mata _st_addvar (8 variables)
. di as text _n "Test 1: Mata _st_addvar (8 vars)..."

Test 1: Mata _st_addvar (8 vars)...

. timer clear 1

. timer on 1

. mata: _st_addvar(("double","double","double","long","long","str20","str20","b
> yte"), ("v1","v2","v3","v4","v5","v6","v7","v8"))
       1   2   3   4   5   6   7   8
    +---------------------------------+
  1 |  1   2   3   4   5   6   7   8  |
    +---------------------------------+

. timer off 1

. timer list 1
   1:      2.02 /        1 =       2.0230

. drop v1-v8

. 
. * Test 2: Java sequential (8 variables, one at a time)
. di as text _n "Test 2: Java AddVar sequential (8 vars)..."

Test 2: Java AddVar sequential (8 vars)...

. timer clear 2

. timer on 2

. javacall AddVar3 create, classpath(`classpath') args(double v1)

. javacall AddVar3 create, classpath(`classpath') args(double v2)

. javacall AddVar3 create, classpath(`classpath') args(double v3)

. javacall AddVar3 create, classpath(`classpath') args(long v4)

. javacall AddVar3 create, classpath(`classpath') args(long v5)

. javacall AddVar3 create, classpath(`classpath') args(str20 v6)

. javacall AddVar3 create, classpath(`classpath') args(str20 v7)

. javacall AddVar3 create, classpath(`classpath') args(byte v8)

. timer off 2

. timer list 2
   2:      0.04 /        1 =       0.0380

. drop v1-v8

. 
. * Test 3: Java batch (single javacall)
. di as text _n "Test 3: Java AddVarBatch (1 call for 8 vars)..."

Test 3: Java AddVarBatch (1 call for 8 vars)...

. timer clear 3

. timer on 3

. javacall AddVarBatch create, classpath(`classpath') args(double+double+double
> +long+long+str20+str20+byte v1+v2+v3+v4+v5+v6+v7+v8)

. timer off 3

. timer list 3
   3:      0.00 /        1 =       0.0000

. drop v1-v8

. 
. * Test 4: Sequential gen for comparison
. di as text _n "Test 4: Sequential gen (8 vars)..."

Test 4: Sequential gen (8 vars)...

. timer clear 4

. timer on 4

. qui gen double v1 = .

. qui gen double v2 = .

. qui gen double v3 = .

. qui gen long v4 = .

. qui gen long v5 = .

. qui gen str20 v6 = ""

. qui gen str20 v7 = ""

. qui gen byte v8 = .

. timer off 4

. timer list 4
   4:      0.00 /        1 =       0.0000

. 
. di as text _n "Done!"

Done!

. 
end of do-file
