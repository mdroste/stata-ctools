
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      StataNow 18.5
___/   /   /___/   /   /___/       MP—Parallel Edition

 Statistics and Data Science       Copyright 1985-2023 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: Unlimited-user 16-core network, expiring  2 Jul 2026
Serial number: 501909320077
  Licensed to: Michael Droste
               Stanford University GSB

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. More than 2 billion observations are allowed; see help obs_advice.
      4. Maximum number of variables is set to 5,000 but can be increased;
          see help set_maxvar.


Running /Users/Mike/Documents/Stata/profile.do ...

. do test_iterations.do 

. clear all

. set more off

. adopath + "../build"
  [1]  (BASE)      "/Applications/Stata/ado/base/"
  [2]  (SITE)      "/Applications/Stata/ado/site/"
  [3]              "."
  [4]  (PERSONAL)  "/Users/Mike/Documents/Stata/ado/personal/"
  [5]  (PLUS)      "/Users/Mike/Library/Application Support/Stata/ado/plus/"
  [6]  (OLDPLACE)  "~/ado/"
  [7]              "../build"

. 
. * Test with different sizes to understand scaling
. foreach n in 100000 500000 1000000 2000000 5000000 {
  2.     clear
  3.     set obs `n'
  4.     set seed 12345
  5.     gen x = rnormal()
  6.     gen y = 2*x + rnormal()*5
  7.     
.     timer clear
  8.     timer on 1
  9.     quietly qreg y x
 10.     timer off 1
 11.     quietly timer list 1
 12.     local qreg_time = r(t1)
 13.     
.     timer clear
 14.     timer on 2
 15.     cqreg y x, denmethod(residual)
 16.     timer off 2
 17.     quietly timer list 2
 18.     local cqreg_time = r(t2)
 19.     local cqreg_iter = e(iterations)
 20.     
.     display "N=`n': qreg=" %5.2f `qreg_time' "s  cqreg=" %5.2f `cqreg_time' "
> s  iterations=`cqreg_iter'  speedup=" %4.2f `qreg_time'/`cqreg_time' "x"
 21. }
Number of observations (_N) was 0, now 100,000.

Median regression                                  Number of obs =    100,000
  Raw sum of deviations 214966   (about .0071241 )
  Min sum of deviations 200067                     Pseudo R2     =     0.0693

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           x |   1.974075   .0203243    97.13   0.000      1.93424    2.013911
       _cons |   .0265265   .0203228     1.31   0.192     -.013306    .0663589
------------------------------------------------------------------------------
N=100000: qreg= 0.20s  cqreg= 0.10s  iterations=.  speedup=2.14x
Number of observations (_N) was 0, now 500,000.

Median regression                                  Number of obs =    500,000
  Raw sum of deviations 1.1e+06  (about .0143501 )
  Min sum of deviations 995934                     Pseudo R2     =     0.0716

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           x |   2.002104   .0088299   226.74   0.000     1.984798     2.01941
       _cons |   .0182709   .0088309     2.07   0.039     .0009626    .0355793
------------------------------------------------------------------------------
N=500000: qreg= 0.85s  cqreg= 0.35s  iterations=.  speedup=2.42x
Number of observations (_N) was 0, now 1,000,000.

Median regression                                  Number of obs =  1,000,000
  Raw sum of deviations 2.1e+06  (about .0038212 )
  Min sum of deviations 2.0e+06                    Pseudo R2     =     0.0713

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           x |   1.995731   .0062976   316.90   0.000     1.983388    2.008074
       _cons |   .0049367   .0062934     0.78   0.433    -.0073982    .0172715
------------------------------------------------------------------------------
N=1000000: qreg= 1.64s  cqreg= 0.97s  iterations=.  speedup=1.68x
Number of observations (_N) was 0, now 2,000,000.

Median regression                                  Number of obs =  2,000,000
  Raw sum of deviations 4.3e+06  (about -.0055898)
  Min sum of deviations 4.0e+06                    Pseudo R2     =     0.0714

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           x |   1.998836   .0044432   449.86   0.000     1.990128    2.007545
       _cons |   -.006364   .0044404    -1.43   0.152    -.0150669     .002339
------------------------------------------------------------------------------
N=2000000: qreg= 3.75s  cqreg= 1.90s  iterations=.  speedup=1.97x
Number of observations (_N) was 0, now 5,000,000.

Median regression                                  Number of obs =  5,000,000
  Raw sum of deviations 1.1e+07  (about -.001789 )
  Min sum of deviations 1.0e+07                    Pseudo R2     =     0.0718

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           x |   1.999809   .0027847   718.14   0.000     1.994351    2.005267
       _cons |  -.0022945   .0027841    -0.82   0.410    -.0077512    .0031622
------------------------------------------------------------------------------
N=5000000: qreg=10.06s  cqreg= 4.61s  iterations=.  speedup=2.18x

. 
end of do-file
