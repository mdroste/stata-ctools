
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      StataNow 18.5
___/   /   /___/   /   /___/       MP—Parallel Edition

 Statistics and Data Science       Copyright 1985-2023 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: Unlimited-user 16-core network, expiring  2 Jul 2026
Serial number: 501909320077
  Licensed to: Michael Droste
               Stanford University GSB

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. More than 2 billion observations are allowed; see help obs_advice.
      4. Maximum number of variables is set to 5,000 but can be increased;
          see help set_maxvar.


Running /Users/Mike/Documents/Stata/profile.do ...

. do validation/validate_cmerge.do 

. /****************************************************************************
> ***
>  * validate_cmerge.do
>  *
>  * Comprehensive validation tests for cmerge vs native Stata merge
>  * Tests all merge types and options
>  *
>  * Merge types: 1:1, m:1, 1:m, m:m
>  * Options: keep(), generate(), nogenerate, keepusing(), sorted, force,
>  *          noreport, nolabel, nonotes, update, replace, assert()
>  ****************************************************************************
> **/
. 
. * Load setup (works from project root or validation dir)
. capture do "validation/validate_setup.do"

. if _rc != 0 {
.     do "validate_setup.do"
. }

. 
. quietly {

----------------------------------------------------------------------
1:1 Merge Tests
----------------------------------------------------------------------
[PASS] 1:1 numeric key
[PASS] 1:1 string key

----------------------------------------------------------------------
m:1 Merge Tests
----------------------------------------------------------------------
[PASS] m:1 foreign lookup
[PASS] m:1 census region

----------------------------------------------------------------------
1:m Merge Tests
----------------------------------------------------------------------
[PASS] 1:m region to states

----------------------------------------------------------------------
m:m Merge Tests
----------------------------------------------------------------------

>>> [FAIL] m:m basic
>>>        merged data differs from Stata merge


----------------------------------------------------------------------
keep() Option Tests
----------------------------------------------------------------------
[PASS] keep(match)
[PASS] keep(master)
[PASS] keep(using)
[PASS] keep(master match)
[PASS] keep(master using)
[PASS] keep(using match)

----------------------------------------------------------------------
generate/nogenerate Options
----------------------------------------------------------------------
[PASS] nogenerate
[PASS] generate(merge_result)

----------------------------------------------------------------------
keepusing() Option
----------------------------------------------------------------------
[PASS] keepusing single var
[PASS] keepusing two vars

----------------------------------------------------------------------
Multiple Key Variables
----------------------------------------------------------------------
[PASS] two keys: idcode year
[PASS] three keys
[PASS] mixed keys: string+numeric

----------------------------------------------------------------------
Edge Cases
----------------------------------------------------------------------
[PASS] no matches
[PASS] all matches
[PASS] missing key values
[PASS] negative keys
[PASS] float keys

----------------------------------------------------------------------
Large Dataset Tests
----------------------------------------------------------------------
[PASS] 50K 1:1 full match
[PASS] 100K m:1
[PASS] partial overlap (50%)

----------------------------------------------------------------------
String Key Tests
----------------------------------------------------------------------
[PASS] long string keys
[PASS] state name 1:1

----------------------------------------------------------------------
Panel Data (nlswork)
----------------------------------------------------------------------
[PASS] panel 1:1
[PASS] panel m:1 individual

----------------------------------------------------------------------
assert() Option Tests
----------------------------------------------------------------------
[PASS] assert(match) passes
[PASS] assert(match) fails correctly

----------------------------------------------------------------------
update/replace Options
----------------------------------------------------------------------
[PASS] update option
[PASS] update replace option

----------------------------------------------------------------------
sorted Option
----------------------------------------------------------------------
[PASS] sorted option

----------------------------------------------------------------------
force Option
----------------------------------------------------------------------
[PASS] force option

----------------------------------------------------------------------
nolabel/nonotes Options
----------------------------------------------------------------------

>>> [FAIL] nolabel option
>>>        returned error 109

[PASS] nonotes option accepted

----------------------------------------------------------------------
FAILED TESTS DETAIL:
----------------------------------------------------------------------
  1. m:m basic: merged data differs from Stata merge
  2. nolabel option: returned error 109
----------------------------------------------------------------------


----------------------------------------------------------------------
SUMMARY: cmerge
----------------------------------------------------------------------
Tests passed: 37 / 39
Tests failed: 2
----------------------------------------------------------------------
VALIDATION FAILED - See failed tests above
----------------------------------------------------------------------
--Break--
--Break--
--Break--
r(1);

end of do-file
--Break--
r(1);
